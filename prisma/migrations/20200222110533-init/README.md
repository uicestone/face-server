# Migration `20200222110533-init`

This migration has been generated by Uice Lu at 2/22/2020, 11:05:33 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Post" (
    "author" text   ,
    "content" text   ,
    "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "id" text  NOT NULL ,
    "published" boolean  NOT NULL DEFAULT true,
    "title" text  NOT NULL DEFAULT '',
    "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."User" (
    "email" text   ,
    "id" text  NOT NULL ,
    "login" text  NOT NULL DEFAULT '',
    "name" text   ,
    "password" text  NOT NULL DEFAULT '',
    "plot" text   ,
    "role" text  NOT NULL DEFAULT '',
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Community" (
    "address" text  NOT NULL DEFAULT '',
    "id" text  NOT NULL ,
    "name" text  NOT NULL DEFAULT '',
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Resident" (
    "age" text  NOT NULL DEFAULT '',
    "community" text  NOT NULL ,
    "id" text  NOT NULL ,
    "level" text  NOT NULL DEFAULT 'BLUE',
    "name" text  NOT NULL DEFAULT '',
    "unit" text  NOT NULL ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Unit" (
    "building" text  NOT NULL DEFAULT '',
    "community" text  NOT NULL ,
    "id" text  NOT NULL ,
    "room" text  NOT NULL DEFAULT '',
    PRIMARY KEY ("id")
) 

CREATE UNIQUE INDEX "User.email" ON "public"."User"("email")

CREATE UNIQUE INDEX "User.login" ON "public"."User"("login")

ALTER TABLE "public"."Post" ADD FOREIGN KEY ("author") REFERENCES "public"."User"("id") ON DELETE SET NULL

ALTER TABLE "public"."User" ADD FOREIGN KEY ("plot") REFERENCES "public"."Community"("id") ON DELETE SET NULL

ALTER TABLE "public"."Resident" ADD FOREIGN KEY ("community") REFERENCES "public"."Community"("id") ON DELETE RESTRICT

ALTER TABLE "public"."Resident" ADD FOREIGN KEY ("unit") REFERENCES "public"."Unit"("id") ON DELETE RESTRICT

ALTER TABLE "public"."Unit" ADD FOREIGN KEY ("community") REFERENCES "public"."Community"("id") ON DELETE RESTRICT
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200222110533-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,60 @@
+datasource db {
+  provider = "postgresql"
+  url      = "postgres://face:1000+faces@stirad.com:8432/face"
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+
+model Post {
+  id        String   @default(cuid()) @id
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+  published Boolean  @default(true)
+  title     String
+  content   String?
+  author    User?
+}
+
+model User {
+  id       String     @default(cuid()) @id
+  email    String?    @unique
+  login    String     @unique
+  password String
+  name     String?
+  role     String
+  plot     Community?
+  posts    Post[]
+}
+
+model Community {
+  id        String     @default(cuid()) @id
+  name      String
+  address   String
+  residents Resident[]
+  units     Unit[]
+  users     User[]
+}
+
+enum AwareLevels {
+  BLUE GREEN YELLOW RED
+}
+
+model Resident {
+  id        String      @default(cuid()) @id
+  level     AwareLevels
+  name      String
+  age       String
+  unit      Unit
+  community Community
+}
+
+model Unit {
+  id        String     @default(cuid()) @id
+  community Community
+  building  String
+  room      String
+  residents Resident[]
+}
```


